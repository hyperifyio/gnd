---
description: "Specify how to invoke and profile benchmarks in the BitNet project."
globs: pkg/bitnet/**/*.go
alwaysApply: false
---

# Running and Profiling Benchmarks

**Purpose:** Standardize commands to execute benchmarks and collect profiling data.

## Basic Benchmark Run

Execute all benchmarks in the module:

```bash
go test -timeout 30s -bench=. ./pkg/bitnet/...
```

## Memory Allocation Profiling

Include memory statistics per operation:

```bash
go test -timeout 30s -bench=. -benchmem ./pkg/bitnet/...
```

## CPU Profiling

Generate a CPU profile for offline analysis:

```bash
go test -timeout 30s -bench=. -cpuprofile=cpu.prof ./pkg/bitnet/...
```

## Memory Profiling

Produce a memory profile file:

```bash
go test -timeout 30s -bench=. -memprofile=mem.prof ./pkg/bitnet/...
```

## Profiling Visualization

After generating profiles, visualize with `go tool pprof`:

```bash
# Visualize CPU profile on local web server
go tool pprof -http=:8080 cpu.prof

# Visualize memory profile
go tool pprof -http=:8081 mem.prof
```
